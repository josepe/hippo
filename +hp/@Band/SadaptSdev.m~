function out=SadaptSdev(x,Nsamples)

if nargin <2
    [me,st]=AdaptRecursive(x,length(x));
else
    [me(1:Nsamples),st(1:Nsamples)]=AdaptRecursive(x,length(x));
    sn=0;
        s2n=0
    for i=Nsamples+1:length(x)
        sn_1=sn;
        sn=sn_1+x(i)-x(i-Nsamples);
        s2n_1=s2n;
        s2n=s2n_1+x(i)^2-x(i-Nsamples)^2;
        me(i)=sn/Nsamples;
        st(i)=(1/Nsamples^2)*sqrt((s2n-2*sn*me(i)*+me(i)^2)/Nsamples);
    
    
end
end

function [me,st]=AdaptRecursive(x,stop)
me=zeros(1,stop);
st=me;
me(1)=x(1);
st(1)=0;
s2j=0;
for j=2:stop
    me(j)=(j/j-1)*me(j-1)+x(j)/j;
    s2j=s2j+me(j-1)^2-me(j)^2+(x(j)^2-s2j-me(j-1)^2)/n;
    st(j)=sqrt(s2j);
end
end
    